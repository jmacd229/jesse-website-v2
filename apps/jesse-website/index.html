<!DOCTYPE html>
<html lang="en">
  <head>
    <script>
      // These functions need to be loaded immediately since we should restore the user's saved config
      // Therefore, they are defined in the head to run as quickly as possible.
      const setTheme = (theme) => {
        if (theme === 'dark') {
          document.querySelector('html')?.classList.add('dark');
          localStorage.setItem('theme', 'dark');
        } else {
          document.querySelector('html')?.classList.remove('dark');
          localStorage.setItem('theme', 'light');
        }
      }
      window.setTheme = setTheme;

      const parseTheme = () => {
        // Attempt to retrieve saved settings if they're valid
        const theme = localStorage.getItem('theme');
        if(theme === 'light' || theme === 'dark') {
          return theme;
        }
        // Otherwise use system defaults
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          return'dark';
        }
        
        return 'light';
      }
      window.parseTheme = parseTheme;
      setTheme(parseTheme());
    </script>
    <script>
      const setAnimations = (isEnabled) => {
        if (isEnabled) {
          document.querySelector('html')?.classList.remove('no-motion');
          localStorage.removeItem('animations-disabled');
        } else {
          document.querySelector('html')?.classList.add('no-motion');
          localStorage.setItem('animations-disabled', true);

        }
      }
      window.setAnimations = setAnimations;

      const getAnimationsSetting = () => {
        // Attempt to retrieve saved settings if they're valid
        const isDisabled = localStorage.getItem('animations-disabled');
        if(isDisabled) {
          return {isEnabled: false};
        }
        // Otherwise use system defaults
        if (window.matchMedia && window.matchMedia('(prefers-reduced-motion)').matches) {
          return {isEnabled: false};
        }
        
        return {isEnabled: true};
      }
      window.getAnimationsSetting = getAnimationsSetting;
      setAnimations(getAnimationsSetting().isEnabled);
    </script>
    <meta charset="utf-8" />
    <title>Jesse MacDougall</title>
    <base href="/" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
